#include <LedControl.h>

LedControl lc = LedControl(11, 13, 10, 1);

const char text[] = "HELLO ARDUINO ";
byte buffer[8] = {0};
int scrollPos = 0;
unsigned long lastScroll = 0;

byte letters[][5] = {
  {0x7F, 0x88, 0x88, 0x88, 0x7F},
  {0xFF, 0x91, 0x91, 0x91, 0x6E},
  {0x7E, 0x81, 0x81, 0x81, 0x42},
  {0xFF, 0x81, 0x81, 0x42, 0x3C},
  {0xFF, 0x91, 0x91, 0x91, 0x81},
  {0xFF, 0x90, 0x90, 0x90, 0x80},
  {0x7E, 0x81, 0x89, 0x89, 0x4E},
  {0xFF, 0x10, 0x10, 0x10, 0xFF},
  {0x81, 0x81, 0xFF, 0x81, 0x81},
  {0x06, 0x01, 0x01, 0x01, 0xFE},
  {0xFF, 0x10, 0x28, 0x44, 0x83},
  {0xFF, 0x01, 0x01, 0x01, 0x01},
  {0xFF, 0x40, 0x20, 0x40, 0xFF},
  {0xFF, 0x20, 0x10, 0x08, 0xFF},
  {0x7E, 0x81, 0x81, 0x81, 0x7E},
  {0xFF, 0x88, 0x88, 0x88, 0x70},
  {0x7E, 0x81, 0x85, 0x82, 0x7D},
  {0xFF, 0x88, 0x8C, 0x8A, 0x71},
  {0x62, 0x91, 0x91, 0x91, 0x8E},
  {0x80, 0x80, 0xFF, 0x80, 0x80},
  {0xFE, 0x01, 0x01, 0x01, 0xFE},
  {0xF0, 0x0C, 0x03, 0x0C, 0xF0},
  {0xFF, 0x02, 0x0C, 0x02, 0xFF},
  {0xC3, 0x24, 0x18, 0x24, 0xC3},
  {0xE0, 0x10, 0x0F, 0x10, 0xE0},
  {0x83, 0x85, 0x99, 0xA1, 0xC1},
  {0x00, 0x00, 0x00, 0x00, 0x00}
};

void setup() {
  lc.shutdown(0, false);
  lc.setIntensity(0, 8);
  lc.clearDisplay(0);
}

void loop() {
  if (millis() - lastScroll > 100) {
    lastScroll = millis();
    scrollText();
    updateDisplay();
    scrollPos++;
    if (scrollPos >= strlen(text) * 5) {
      scrollPos = 0;
    }
  }
}

void scrollText() {
  for (int i = 0; i < 8; i++) {
    buffer[i] = 0;
  }
  
  int charIndex = scrollPos / 5;
  int pixelOffset = scrollPos % 5;
  
  for (int i = 0; i < 8; i++) {
    for (int j = 0; j < 5; j++) {
      int currentChar = text[(charIndex + i) % strlen(text)] - 'A';
      if (currentChar < 0 || currentChar > 25) currentChar = 26; // Space
      
      if (j >= pixelOffset) {
        buffer[i] |= (letters[currentChar][j - pixelOffset] >> 2) << i;
      }
    }
  }
}

void updateDisplay() {
  for (int row = 0; row < 8; row++) {
    lc.setRow(0, row, buffer[row]);
  }
}
